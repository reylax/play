(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5099:function(e,r,n){"use strict";n.d(r,{Z:function(){return f}});var t=n(5893),o=n(1975);function i(e){var r=e.numOfcomments,n=e.size,i=e.toggle;return(0,t.jsxs)("div",{className:"flex items-center group hover:text-green-500 cursor-pointer group",children:[(0,t.jsx)("div",{className:"".concat(n," p-1.5 rounded-full mr-1 group-hover:bg-blue-100"),onClick:function(e){i(),e.stopPropagation()},children:(0,t.jsx)(o.COMMENT,{})}),r>0&&(0,t.jsx)("p",{className:"text-c-hint group-hover:text-green-500",children:r})]})}var s=n(402);function u(e){var r=e.size;return(0,t.jsx)("div",{className:"flex items-center group hover:text-green-500 cursor-pointer group",children:(0,t.jsx)("div",{className:"".concat(r," p-1.5 rounded-full  group-hover:bg-blue-100"),children:(0,t.jsx)(o.SHARE,{})})})}function a(e){var r=e.subject,n=e.referId,o=e.size,a=e.replyLevel,l=e.numberOfreplies,c=e.numberOfpros,d=e.LeaveCommentCardToggle;return(0,t.jsxs)("div",{className:"flex space-x-12 relative py-1.5",children:[a>0&&(0,t.jsx)(i,{numOfcomments:l,size:o,toggle:d}),a>0&&(0,t.jsx)(u,{size:o}),(0,t.jsx)(s.Z,{size:o,numberOfpros:c,referId:n,subject:r})]})}function l(e){var r=e.authorAvatar,n=e.authorName;return(0,t.jsxs)("div",{className:"rounded-full relative",children:[(0,t.jsx)("div",{className:"cursor-pointer peer",children:(0,t.jsx)("img",{className:"rounded-full",src:r||"/defaultavatar.png",alt:""})}),(0,t.jsx)("div",{className:"absolute top-1/4 right-full mr-2 h-3/4 flex items-center invisible peer-hover:visible bg-gray-900 rounded-md p-1.5",children:(0,t.jsx)("pre",{className:"text-white",children:(0,t.jsx)("span",{children:n})})})]})}var c=n(7294),d=n(9058),v=n(8995);function f(e){var r=e.id,n=e.content,o=e.authorName,i=e.authorAvatar,s=e.size,u=e.replyLevel,f=e.numberOfpros,m=e.numberOfreplies,h=e.subject,p=(0,c.useState)(!1),x=p[0],b=p[1],j=(0,c.useState)(!1),g=j[0],N=j[1];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("section",{className:"flex justify-between border-b pr-2 pl-5 cursor-pointer w-full",onClick:function(){return b((function(e){return!e}))},children:[(0,t.jsxs)("div",{className:"flex-1 mr-4",children:[(0,t.jsx)("div",{className:"pt-2",children:(0,t.jsx)("p",{className:"break-all",children:n})}),(0,t.jsx)("div",{children:(0,t.jsx)(a,{referId:r,size:s,replyLevel:u,numberOfreplies:m,numberOfpros:f,LeaveCommentCardToggle:function(){return N((function(e){return!e}))},subject:h})})]}),(0,t.jsx)("div",{className:"w-12 h-12 mt-3.5 mr-1",children:(0,t.jsx)(l,{authorName:o,authorAvatar:i})})]}),g&&(0,t.jsx)("section",{children:(0,t.jsx)(v.Z,{subject:h,id:r,close:function(){return N((function(e){return!e}))}})}),(0,t.jsx)("section",{className:1==u?"border-l border-primary-400":"",children:x&&(0,t.jsx)(d.Z,{subject:h,id:r,replyLevel:u-1})})]})}},9058:function(e,r,n){"use strict";n.d(r,{Z:function(){return c}});var t=n(5893),o=n(7261),i=n(5099),s=n(2527),u=n(6829);function a(){var e=(0,o.Z)(["\n  query ($subject:String!, $id:String!) {\n    getComments(subject:$subject, id:$id) {\n      _id\n      author\n      authorName\n      authorAvatar\n      content\n      numberOfpros\n      numberOfreplies\n    }\n  }\n"]);return a=function(){return e},e}var l=(0,s.ZP)(a());function c(e){var r=e.subject,n=e.id,o=e.replyLevel,s=(0,u.useQuery)(l,{variables:{subject:r,id:n},fetchPolicy:"network-only"}),a=s.data;return s.loading||!a?(0,t.jsx)("p",{}):(0,t.jsx)("div",{className:"max-h-100 overflow-y-auto scrollbar-hide",onWheel:function(e){return e.stopPropagation()},children:a.getComments.map((function(e){var r=e._id,n=e.content,s=e.authorName,u=e.authorAvatar,a=e.numberOfpros,l=e.numberOfreplies;return(0,t.jsx)(i.Z,{id:r,content:n,authorName:s,authorAvatar:u,size:"h-7.5 w-7.5",replyLevel:o,numberOfpros:a,numberOfreplies:l,subject:"comment"},r)}))})}},8995:function(e,r,n){"use strict";n.d(r,{Z:function(){return v}});var t=n(5893),o=n(4121),i=n(7261),s=n(2527),u=n(6829),a=n(7294),l=n(8342);function c(){var e=(0,i.Z)(["\n  mutation ($comment:String!) {\n    leaveComment(comment:$comment) {\n      status\n      message\n    }\n  }\n"]);return c=function(){return e},e}var d=(0,s.ZP)(c());function v(e){var r=e.subject,n=e.id,i=e.close,s=(0,a.useState)(!1),c=s[0],v=s[1],f=(0,a.useState)(0),m=f[0],h=f[1],p=(0,a.useState)(""),x=p[0],b=p[1],j=(0,a.useState)(!1),g=j[0],N=j[1],y=(0,l.Fg)().user,O=y.username,w=y.avatar,Z=y._id,k=(0,u.useMutation)(d,{variables:{comment:JSON.stringify({subject:r,referId:n,content:x,authorName:O,authorAvatar:w,author:Z})},onCompleted:function(e){console.log(e),b(""),i&&i(),N(!1)},onError:function(e){console.log(e)}}),C=(0,o.Z)(k,2),I=C[0],A=C[1].loading;return(0,t.jsx)("div",{className:"flex flex-col py-5",children:(0,t.jsxs)("div",{className:"self-stretch",children:[(0,t.jsx)("input",{onFocus:function(){v(!0),N(!0)},onBlur:function(){return v(!1)},className:"outline-none w-full px-5 py-1 ".concat(c?"border-b border-black":"border-b"),placeholder:"leave comment",value:x,onChange:function(e){var r=e.target.value;b(r),h(r.length)},autoFocus:!!Boolean(i)}),g&&(0,t.jsxs)("div",{className:"px-2 py-1 flex justify-between",children:[(0,t.jsx)("button",{className:"px-3.5 border ".concat(m>0&&"border-red-500"," rounded-sm hover:bg-red-50 hover:text-red-500 font-medium"),onClick:function(e){e.stopPropagation(),Boolean(i)&&i(),N(!1)},children:"\u5220\u9664"}),(0,t.jsx)("div",{className:"relative flex justify-center items-center",children:(0,t.jsxs)("button",{className:"".concat(m>0?"bg-green-500":"bg-gray-500"," px-3.5  hover:bg-green-600 active:bg-green-700 text-white rounded-sm"),onClick:function(){return I()},children:[(0,t.jsx)("p",{className:"font-display text-white",children:"\u53d1\u8868"}),(0,t.jsx)("div",{className:"fixed-center",children:A&&(0,t.jsx)("img",{src:"/loading.svg",alt:"pending..."})})]})})]})]})})}},402:function(e,r,n){"use strict";n.d(r,{Z:function(){return f}});var t=n(5893),o=n(4121),i=n(7261),s=n(7294),u=n(1975),a=n(2527),l=n(6829),c=n(8342);function d(){var e=(0,i.Z)(["\n  mutation ($subject:String!, $referId: String!, $inc: Int!) {\n    like(subject:$subject, referId:$referId, inc:$inc) {\n      status\n      message\n    }\n  }\n"]);return d=function(){return e},e}var v=(0,a.ZP)(d());function f(e){var r,n=e.size,i=e.numberOfpros,a=e.referId,d=e.subject,f=(0,c.Fg)().user,m=(0,s.useState)(0),h=m[0],p=m[1],x=(0,l.useMutation)(v),b=(0,o.Z)(x,1)[0];(0,s.useEffect)((function(){p(i)}),[i]);var j=null===f||void 0===f||null===(r=f.liked)||void 0===r?void 0:r.has(a),g=j?"text-red-500":"text-c-body";return(0,t.jsxs)("div",{className:"flex items-center group hover:text-red-500 cursor-pointer group",onClick:function(e){var r,n;e.stopPropagation(),null!==f&&void 0!==f&&null!==(r=f.liked)&&void 0!==r&&r.has(a)?(p((function(e){return e-1})),n=-1,f.liked.delete(a)):(p((function(e){return e+1})),n=1,f.liked.add(a)),b({variables:{subject:d,referId:a,inc:n}})},children:[(0,t.jsx)("div",{className:"".concat(n," ").concat(g," p-1.5 rounded-full mr-1 group-hover:bg-red-100"),children:j?(0,t.jsx)(u.LIKEED,{}):(0,t.jsx)(u.HEART,{})}),h>0&&(0,t.jsx)("p",{className:"".concat(g," text-c-hint group-hover:text-red-500"),children:h})]})}},4830:function(e,r,n){"use strict";n.r(r),n.d(r,{default:function(){return p}});var t=n(5893),o=n(3206),i=n(7261),s=n(6829),u=n(2527),a=n(7294),l=n(5099);function c(e){var r=e.id,n=e.title,o=e.authorName,i=e.authorAvatar,s=e.numberOfpros,u=e.numberOfreplies;return(0,t.jsx)(l.Z,{id:r,content:n,authorName:o,authorAvatar:i,numberOfpros:s,numberOfreplies:u,size:"w-9 h-9",replyLevel:2,subject:"video"})}function d(){var e=(0,i.Z)(["\n  query ($videoId: String!) {\n    getVideo(videoId: $videoId) {\n      id,\n      title,\n      content,\n      numberOfpros,\n      numberOfreplies,\n      authorName,\n      authorAvatar,\n      createdAt,\n    }\n  }\n"]);return d=function(){return e},e}var v=(0,u.ZP)(d());function f(e){var r,n,o,i,u,l,d,f=e.videoId,m=(0,s.useQuery)(v,{fetchPolicy:"network-only",variables:{videoId:f},onError:console.error}).data,h=(0,a.useRef)(null);return(0,a.useEffect)((function(){var e=h.current;null===e||void 0===e||e.load()}),[m]),(0,t.jsx)("div",{className:"border-b relative",children:(0,t.jsxs)("div",{className:"cursor-pointer pt-4",children:[(0,t.jsx)("section",{className:"mr-12 px-5 py-3",children:(0,t.jsx)("div",{id:"video",className:"rounded-xl",children:(0,t.jsxs)("video",{ref:h,controls:!0,controlsList:"nodownload",className:"rounded-xl w-full",children:[(0,t.jsx)("source",{src:null===m||void 0===m||null===(r=m.getVideo)||void 0===r?void 0:r.content,type:"video/mp4"}),"Your browser does not support the video tag."]})})}),(0,t.jsx)("main",{id:"text",className:"flex justify-between items-center",children:(0,t.jsx)("section",{className:"w-full",children:(0,t.jsx)(c,{id:null===m||void 0===m||null===(n=m.getVideo)||void 0===n?void 0:n.id,authorName:null===m||void 0===m||null===(o=m.getVideo)||void 0===o?void 0:o.authorName,authorAvatar:null===m||void 0===m||null===(i=m.getVideo)||void 0===i?void 0:i.authorAvatar,numberOfpros:null===m||void 0===m||null===(u=m.getVideo)||void 0===u?void 0:u.numberOfpros,numberOfreplies:null===m||void 0===m||null===(l=m.getVideo)||void 0===l?void 0:l.numberOfreplies,title:null===m||void 0===m||null===(d=m.getVideo)||void 0===d?void 0:d.title})})})]})})}var m=["6207d5195e3caf4598bfc15f"];function h(){return(0,t.jsx)(o.Z,{Page:function(){return(0,t.jsx)("div",{children:m.map((function(e){return(0,t.jsx)(f,{videoId:e},e)}))})}})}function p(){return(0,t.jsx)(h,{})}},5301:function(e,r,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(4830)}])}},function(e){e.O(0,[294,206,774,888,179],(function(){return r=5301,e(e.s=r);var r}));var r=e.O();_N_E=r}]);